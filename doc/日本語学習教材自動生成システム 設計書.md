# **日本語学習教材自動生成システム 設計書**

## **1. プロジェクト概要**

### **目的**

本プロジェクトでは、N5レベルの日本語学習教材をAI＋プログラムを活用して完全自動生成することを目指す。

### **目標**

1. **スキャン画像からテキストをOCR処理**し、日本語の文法ポイントを抽出
2. **GPT-4を使用し、文法スクリプトを自動生成**
3. **スライドを動的に作成**し、文法解説を視覚化
4. **HeyGen APIを使用し、複数アバターを用いた動画を自動生成**
5. **スライドと動画の同期を自動調整**
6. **MoodleにH5P/SCORM形式で登録し、学習管理**
7. **クイズを自動生成し、Moodleでの学習効果を向上**

---

## **2. システムアーキテクチャ**

### **技術スタック**

| 機能                | 技術候補                   |
| ----------------- | ---------------------- |
| **OCR（スキャン画像解析）** | Tesseract OCR          |
| **文法解析・スクリプト生成**  | GPT-4 API              |
| **スライド生成**        | Google Slides API      |
| **動画生成**          | HeyGen API（複数アバター対応）   |
| **動画とスライドの同期**    | 動画音声解析 + JSONで同期情報管理   |
| **Moodle自動登録**    | Moodle API（SCORM, H5P） |
| **クイズ自動生成**       | GPT-4 + CSVインポート       |
| **プロジェクト管理**      | GitHub Issues          |

---

## **3. データフォーマット定義**

### **1️⃣ OCR処理の出力フォーマット**

```json
{
  "text": "これはペンです。",
  "grammar_point": "これは～です。",
  "translation": "This is a pen."
}
```

**補足**:

- 文法ポイントは事前定義リストと照合して特定する。
- 余計な改行や特殊文字をフィルタリングする。

### **2️⃣ GPT-4による文法スクリプト生成**

```json
{
  "grammar": "これは～です",
  "explanation": "「これは～です」は物の名前を言う時に使う文法です。",
  "examples": [
    "これは本です。",
    "これはスマートフォンです。"
  ]
}
```

**補足**:

- GPT-4による文法説明は、**学習レベル（N5/N4）に応じてカスタマイズ可能**。
- 例文は最低2つを出力する。

### **3️⃣ スライド生成フォーマット（Google Slides API）**

```json
{
  "title": "文法ポイント: これは～です",
  "content": [
    {"text": "例文1: これは本です。", "position": "left"},
    {"text": "例文2: これはスマートフォンです。", "position": "right"}
  ]
}
```

**補足**:

- スライドのフォントサイズ、背景色、テキスト位置は事前テンプレートで定義。

### **4️⃣ HeyGen APIによる動画生成フォーマット**

```json
{
  "characters": [
    {"name": "Teacher", "voice": "female", "role": "explanation"},
    {"name": "Student", "voice": "male", "role": "question"}
  ],
  "script": [
    {"speaker": "Teacher", "text": "これはペンです。"},
    {"speaker": "Student", "text": "これは何ですか？"}
  ]
}
```

**補足**:

- **アバターの役割分担**（教師役/学習者役）を決める。
- **HeyGenの音声データ取得により、スライド切り替え時間を同期**。

### **5️⃣ Moodle APIへの登録フォーマット（H5P/SCORM）**

```json
{
  "type": "H5P",
  "content": "grammar_lesson_1.h5p",
  "title": "これは～です",
  "description": "基本文型の解説"
}
```

**補足**:

- H5PとSCORMのどちらを使用するかは、運用方針に応じて決定。
- クイズデータの登録方法も統一する。

### **6️⃣ クイズ自動生成のフォーマット**

```json
{
  "question": "「これは～です」の正しい例文はどれ？",
  "options": [
    "これはペンです。",
    "これは走ります。",
    "これは食べます。"
  ],
  "correct_answer": "これはペンです。"
}
```

**補足**:

- GPT-4を利用し、選択問題・並べ替え問題を自動作成。
- JSONをCSV変換し、Moodleにインポート可能。

---

## **4. システム構成（変更なし）**

（省略）

## **5. GitHub Issues タスク一覧（変更なし）**

（省略）

## **6. 次のステップ（変更なし）**

（省略）

---

以上の内容で設計書を更新しました。 このフォーマットでDevinの開発がスムーズに進むか、確認をお願いします！

